<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="ExcelClone.Views.SpreadsheetPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:locales="clr-namespace:ExcelClone.Resources.Localization"
             Title="{x:Static locales:AppResources.ApplicationName}">

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="{x:Static locales:AppResources.HomePage}"
                Clicked="OnHomeClicked"/>
        <ToolbarItem Text="{x:Static locales:AppResources.HelpPage}"
                Clicked="OnHelpClicked"/>
        <ToolbarItem Text="{x:Static locales:AppResources.SaveFile}"
                Clicked="OnSaveClicked"/>
        <ToolbarItem Text="{x:Static locales:AppResources.SaveToGoogleDrive}"
                Clicked="OnGoogleDriveSaveClicked"/>
    </ContentPage.ToolbarItems>

    <Grid RowDefinitions="Auto,Auto,Auto,*"
          ColumnDefinitions="*"
          Padding="15"
          RowSpacing="15">

        <!-- Input Section -->
        <Border Grid.Row="0"
                BackgroundColor="#f5f5f5"
                Padding="15">
            <VerticalStackLayout Spacing="10">
                <Label Text="{x:Static locales:AppResources.EnterGridDimensions}"
                        FontSize="16"
                        FontAttributes="Bold"/>
                <Grid ColumnDefinitions="Auto,*,Auto,*"
                        RowDefinitions="Auto,Auto"
                        ColumnSpacing="10"
                        RowSpacing="10">
                    <Label Text="{x:Static locales:AppResources.EnterColumns}"
                            Grid.Row="0"
                            Grid.Column="0"
                            VerticalOptions="Center"/>
                    <Entry x:Name="ColumnsEntry"
                            Grid.Row="0"
                            Grid.Column="1"
                            Text="10"/>
                    <Label Text="{x:Static locales:AppResources.EnterRows}"
                            Grid.Row="0"
                            Grid.Column="2"
                            VerticalOptions="Center"/>
                    <Entry x:Name="RowsEntry"
                            Grid.Row="0"
                            Grid.Column="3"
                            Text="20"/>
                </Grid>
                <Grid ColumnDefinitions="6*,4*" ColumnSpacing="10">
                        <Button Grid.Column="0"
                                x:Name="GenerateButton"
                                Text="{x:Static locales:AppResources.GenerateGrid}"
                                Clicked="OnGenerateClicked"
                                BackgroundColor="#217346"
                                TextColor="White"/>
                        
                        <Grid Grid.Column="1" ColumnDefinitions="7*,3*" ColumnSpacing="10">
                                <Label Grid.Column="0" Text="{x:Static locales:AppResources.ShowFormulasInsteadOfValues}"
                                        VerticalOptions="Center"
                                        HorizontalOptions="End"/>

                                <Switch Grid.Column="1" x:Name="DisplayModeSwitch" 
                                        Toggled="OnDisplayModeToggle"
                                        VerticalOptions="Center"
                                        HorizontalOptions="Start"/>
                        </Grid>

                </Grid>
            </VerticalStackLayout>
        </Border>

        <!-- Excel-like Formula Bar -->
        <Border Grid.Row="1"
                BackgroundColor="#f8f9fa"
                Padding="10"
                x:Name="FormulaBarContainer">
            <Grid ColumnDefinitions="Auto,*"
                    ColumnSpacing="10">
                <Label Text="fx"
                        Grid.Column="0"
                        FontAttributes="Bold"
                        TextColor="#666"
                        VerticalOptions="Center"/>
                <Grid ColumnDefinitions="Auto,*"
                        Grid.Column="1">
                    <Border BackgroundColor="#e8eaed"
                            Padding="8,5"
                            WidthRequest="60">
                        <Label x:Name="ActiveCellLabel"
                                Text="A1"
                                FontSize="12"
                                VerticalOptions="Center"/>
                    </Border>
                    <Entry x:Name="FormulaEntry"
                            Grid.Column="1"
                           Placeholder="{x:Static locales:AppResources.EnterValuePlaceholder}"
                           Completed="OnFormulaEntryCompleted"/>
                </Grid>
            </Grid>
        </Border>

        <Grid Grid.Row="2" ColumnDefinitions="*,Auto" Padding="2" HorizontalOptions="Fill" HeightRequest="30">
            <Label x:Name="StatusLabel"
                Text=""
                FontSize="14"
                HorizontalOptions="Center"
                VerticalOptions="Center"/>

            <ActivityIndicator x:Name="LoadingIndicator"
                            IsRunning="False"
                            IsVisible="False"
                            WidthRequest="25"
                            HeightRequest="25"
                            HorizontalOptions="End"
                            VerticalOptions="Center"/>
        </Grid>

        <!-- Grid Container -->
        <Border x:Name="GridContainer"
                Grid.Row="3"
                BackgroundColor="White"
                Stroke="#cccccc"
                StrokeThickness="1"
                Margin="0,0,0,20">

            <Grid RowDefinitions="Auto,*"
                    ColumnDefinitions="Auto,*">

                <!-- Corner -->
                <Border x:Name="CornerCell"
                        Grid.Row="0"
                        Grid.Column="0"
                        BackgroundColor="#217346"
                        Stroke="#cccccc"
                        StrokeThickness="1"
                        WidthRequest="40"
                        HeightRequest="25"/>

                <!-- Column Headers -->
                <ScrollView x:Name="ColumnHeadersScroll"
                        Grid.Row="0"
                        Grid.Column="1"
                            Orientation="Horizontal"
                        Scrolled="OnColumnHeadersScrolled">
                    <StackLayout x:Name="ColumnHeadersLayout"
                            Orientation="Horizontal"/>
                </ScrollView>

                <!-- Row Headers -->
                <ScrollView x:Name="RowHeadersScroll"
                        Grid.Row="1"
                        Grid.Column="0"
                            Orientation="Vertical"
                        Scrolled="OnRowHeadersScrolled">
                    <StackLayout x:Name="RowHeadersLayout"
                            Orientation="Vertical"/>
                </ScrollView>

                <!-- Data Grid -->
                <ScrollView x:Name="DataGridScroll"
                        Grid.Row="1"
                        Grid.Column="1"
                            Orientation="Both"
                        Scrolled="OnDataGridScrolled">
                    <AbsoluteLayout x:Name="DataGridLayout"/>
                </ScrollView>

            </Grid>
        </Border>

    </Grid>
</ContentPage>